
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Ramon de C Valle">
      
      
        <link rel="canonical" href="https://rcvalle.com/posts/2020-09-16-rust-exploit-mitigations/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.7">
    
    
      
        <title>Rust exploit mitigations - rcvalle's Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-63YYV7T3EM"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-63YYV7T3EM",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-63YYV7T3EM"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://rcvalle.com" title="rcvalle&#39;s Notes" class="md-header__button md-logo" aria-label="rcvalle's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rcvalle's Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rust exploit mitigations
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://rcvalle.com" title="rcvalle&#39;s Notes" class="md-nav__button md-logo" aria-label="rcvalle's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    rcvalle's Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome to MkDocs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../metasploit/" class="md-nav__link">
        Metasploit
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../vulnerabilities/" class="md-nav__link">
        Vulnerabilities
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Posts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Posts" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Posts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Rust exploit mitigations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Rust exploit mitigations
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploit-mitigations" class="md-nav__link">
    Exploit mitigations
  </a>
  
    <nav class="md-nav" aria-label="Exploit mitigations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#position-independent-executable" class="md-nav__link">
    Position-independent executable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integer-overflow-checks" class="md-nav__link">
    Integer overflow checks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-executable-memory-regions" class="md-nav__link">
    Non-executable memory regions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stack-clashing-protection" class="md-nav__link">
    Stack clashing protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-only-relocations-and-immediate-binding" class="md-nav__link">
    Read-only relocations and immediate binding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-corruption-protection" class="md-nav__link">
    Heap corruption protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stack-smashing-protection" class="md-nav__link">
    Stack smashing protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-edge-control-flow-protection" class="md-nav__link">
    Forward-edge control flow protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backward-edge-control-flow-protection" class="md-nav__link">
    Backward-edge control flow protection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploit-mitigations" class="md-nav__link">
    Exploit mitigations
  </a>
  
    <nav class="md-nav" aria-label="Exploit mitigations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#position-independent-executable" class="md-nav__link">
    Position-independent executable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integer-overflow-checks" class="md-nav__link">
    Integer overflow checks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#non-executable-memory-regions" class="md-nav__link">
    Non-executable memory regions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stack-clashing-protection" class="md-nav__link">
    Stack clashing protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-only-relocations-and-immediate-binding" class="md-nav__link">
    Read-only relocations and immediate binding
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-corruption-protection" class="md-nav__link">
    Heap corruption protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stack-smashing-protection" class="md-nav__link">
    Stack smashing protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-edge-control-flow-protection" class="md-nav__link">
    Forward-edge control flow protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backward-edge-control-flow-protection" class="md-nav__link">
    Backward-edge control flow protection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    Appendix
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
  
                


  <h1>Rust exploit mitigations</h1>

<p>The contents of this post are now part of the official Rust documentation
as <a href="https://doc.rust-lang.org/nightly/rustc/exploit-mitigations.html">part of the The rustc
book</a>.
{: .lead}</p>
<p>This post documents the exploit mitigations supported by the Rust
compiler, and is by no means an extensive survey of the Rust programming
language’s security features.</p>
<p>This post is for software engineers working with the Rust programming
language, and assumes prior knowledge of the Rust programming language and
its toolchain.</p>
<h2 id="introduction">Introduction</h2>
<p>The Rust programming language provides memory[1] and thread[2] safety
guarantees via its ownership[3], references and borrowing[4], and slice
types[5] features. However, Unsafe Rust[6] introduces unsafe blocks, unsafe
functions and methods, unsafe traits, and new types that are not subject to
the borrowing rules.</p>
<p>Parts of the Rust standard library are implemented as safe abstractions over
unsafe code (and historically have been vulnerable to memory corruption[7]).
Furthermore, the Rust code and documentation encourage creating safe
abstractions over unsafe code. This can cause a false sense of security if
unsafe code is not properly reviewed and tested.</p>
<p>Unsafe Rust introduces features that do not provide the same memory and
thread safety guarantees. This causes programs or libraries to be
susceptible to memory corruption (CWE-119)[8] and concurrency issues
(CWE-557)[9]. Modern C and C++ compilers provide exploit mitigations to
increase the difficulty to exploit vulnerabilities resulting from these
issues. Therefore, the Rust compiler must also support these exploit
mitigations in order to mitigate vulnerabilities resulting from the use of
Unsafe Rust. This post documents these exploit mitigations and how they
apply to Rust.</p>
<!-- more -->

<p>This post does not discuss the effectiveness of these exploit mitigations
as they vary greatly depending on several factors besides their design and
implementation, but rather describe what they do, so their effectiveness can
be understood within a given context.</p>
<h2 id="exploit-mitigations">Exploit mitigations</h2>
<p>This section documents the exploit mitigations applicable to the Rust
compiler when building programs for the Linux operating system on the AMD64
architecture and equivalent.<sup id="fnref:1" role="doc-noteref"><a
href="#fn:1" class="footnote">1</a></sup> All examples in this section were
built using the Rust compiler version 1.40.0 (2019-12-19) on Debian testing
(Bullseye).</p>
<p>The Rust Programming Language currently has no specification. The Rust
compiler (i.e., rustc) is the language reference implementation. All
references to “the Rust compiler” in this post refer to the language
reference implementation.</p>
<p>Table I \
Summary of exploit mitigations supported by the Rust compiler when building
programs for the Linux operating system on the AMD64 architecture and
equivalent.
{: .table-title}</p>
<table class="table">
  <tr>
   <td><strong>Exploit mitigation</strong>
   </td>
   <td><strong>Supported and enabled by default</strong>
   </td>
   <td><strong>Since</strong>
   </td>
  </tr>
  <tr>
   <td>Position-independent executable
   </td>
   <td>Yes
   </td>
   <td>0.12.0 (2014-10-09)
   </td>
  </tr>
  <tr>
   <td>Integer overflow checks
   </td>
   <td>Yes (enabled when debug assertions are enabled, and disabled when debug assertions are disabled)
   </td>
   <td>1.1.0 (2015-06-25)
   </td>
  </tr>
  <tr>
   <td>Non-executable memory regions
   </td>
   <td>Yes
   </td>
   <td>1.8.0 (2016-04-14)
   </td>
  </tr>
  <tr>
   <td>Stack clashing protection
   </td>
   <td>Yes
   </td>
   <td>1.20.0 (2017-08-31)
   </td>
  </tr>
  <tr>
   <td>Read-only relocations and immediate binding
   </td>
   <td>Yes
   </td>
   <td>1.21.0 (2017-10-12)
   </td>
  </tr>
  <tr>
   <td>Heap corruption protection
   </td>
   <td>Yes
   </td>
   <td>1.32.0 (2019-01-17) (via operating system default or specified allocator)
   </td>
  </tr>
  <tr>
   <td>Stack smashing protection
   </td>
   <td>No
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Forward-edge control flow protection
   </td>
   <td>Yes
   </td>
   <td>Nightly
   </td>
  </tr>
  <tr>
   <td>Backward-edge control flow protection (e.g., shadow and safe stack)
   </td>
   <td>No
   </td>
   <td>
   </td>
  </tr>
</table>

<p>1. See
<a href="https://github.com/rust-lang/rust/tree/master/compiler/rustc_target/src/spec">https://github.com/rust-lang/rust/tree/master/compiler/rustc_target/src/spec</a>
for a list of targets and their default options. <a href="#fnref:1"
class="reversefootnote" role="doc-backlink">↩</a>
{: .fn #fn:1}</p>
<h3 id="position-independent-executable">Position-independent executable</h3>
<p>Position-independent executable increases the difficulty of the use of code
reuse exploitation techniques, such as return-oriented programming (ROP) and
variants, by generating position-independent code for the executable, and
instructing the dynamic linker to load it similarly to a shared object at a
random load address, thus also benefiting from address-space layout
randomization (ASLR). This is also referred to as “full ASLR”.</p>
<p>The Rust compiler supports position-independent executable, and enables it
by default since version 0.12.0 (2014-10-09)[10]–[13].</p>
<pre><code>$ readelf -h target/release/hello-rust | grep Type:
  Type:                              DYN (Shared object file)
</code></pre>
<p>Fig. 1. Checking if an executable is a position-independent executable.
{: .figure-caption}</p>
<p>An executable with an object type of <code>ET_DYN</code> (i.e., shared object) and not
<code>ET_EXEC</code> (i.e., executable) is a position-independent executable (see Fig.
1).</p>
<h3 id="integer-overflow-checks">Integer overflow checks</h3>
<p>Integer overflow checks protects programs from undefined and unintended
behavior (which may cause vulnerabilities) by checking for results of signed
and unsigned integer computations that cannot be represented in their type,
resulting in an overflow or wraparound.</p>
<p>The Rust compiler supports integer overflow checks, and enables it when
debug assertions are enabled since version 1.0.0 (2015-05-15)[14]–[17], but
support for it was not completed until version 1.1.0 (2015-06-25)[16]. An
option to control integer overflow checks was later stabilized in version
1.17.0 (2017-04-27)[18]–[20].</p>
<pre><code class="language-rust">fn main() {
    let u: u8 = 255;
    println!(&quot;u: {}&quot;, u + 1);
}
</code></pre>
<p>Fig. 2. hello-rust-integer program.
{: .figure-caption}</p>
<pre><code>$ cargo run
   Compiling hello-rust-integer v0.1.0 (/home/rcvalle/hello-rust-integer)
    Finished dev [unoptimized + debuginfo] target(s) in 0.23s
     Running `target/debug/hello-rust-integer`
thread 'main' panicked at 'attempt to add with overflow', src/main.rs:3:23
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace.
</code></pre>
<p>Fig. 3. Build and execution of hello-rust-integer with debug assertions
enabled.
{: .figure-caption}</p>
<pre><code>$ cargo run --release
   Compiling hello-rust-integer v0.1.0 (/home/rcvalle/hello-rust-integer)
    Finished release [optimized] target(s) in 0.23s
     Running `target/release/hello-rust-integer`
u: 0
</code></pre>
<p>Fig. 4. Build and execution of hello-rust-integer with debug assertions
disabled.
{: .figure-caption}</p>
<p>Integer overflow checks are enabled when debug assertions are enabled (see
Fig. 3), and disabled when debug assertions are disabled (see Fig. 4). To
enable integer overflow checks independently, use the option to control
integer overflow checks, scoped attributes, or explicit checking methods
such as <code>checked_add</code><sup id="fnref:2" role="doc-noteref"><a href="#fn:2"
class="footnote">2</a></sup>.</p>
<p>It is recommended that explicit wrapping methods such as <code>wrapping_add</code> be
used when wrapping semantics are intended, and that explicit checking and
wrapping methods always be used when using Unsafe Rust.</p>
<p>2. See <a href="https://doc.rust-lang.org/std/primitive.u32.html">https://doc.rust-lang.org/std/primitive.u32.html</a> for more
information on the checked, overflowing, saturating, and wrapping methods
(using u32 as an example). <a href="#fnref:2" class="reversefootnote"
role="doc-backlink">↩</a>
{: .fn #fn:2}</p>
<h3 id="non-executable-memory-regions">Non-executable memory regions</h3>
<p>Non-executable memory regions increase the difficulty of exploitation by
limiting the memory regions that can be used to execute arbitrary code. Most
modern processors provide support for the operating system to mark memory
regions as non executable, but it was previously emulated by software, such
as in grsecurity/PaX's
<a href="https://pax.grsecurity.net/docs/pageexec.txt">PAGEEXEC</a> and
<a href="https://pax.grsecurity.net/docs/segmexec.txt">SEGMEXEC</a>, on processors that
did not provide support for it. This is also known as “No Execute (NX) Bit”,
“Execute Disable (XD) Bit”, “Execute Never (XN) Bit”, and others.</p>
<p>The Rust compiler supports non-executable memory regions, and enables it by
default since its initial release, version 0.1 (2012-01-20)[21], [22], but
has regressed since then[23]–[25], and enforced by default since version
1.8.0 (2016-04-14)[25].</p>
<pre><code>$ readelf -l target/release/hello-rust | grep -A 1 GNU_STACK
  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000
                 0x0000000000000000 0x0000000000000000  RW     0x10
</code></pre>
<p>Fig. 5. Checking if non-executable memory regions are enabled for a given
binary.
{: .figure-caption}</p>
<p>The presence of an element of type <code>PT_GNU_STACK</code> in the program header
table with the <code>PF_X</code> (i.e., executable) flag unset indicates non-executable
memory regions<sup id="fnref:3" role="doc-noteref"><a href="#fn:3"
class="footnote">3</a></sup> are enabled for a given binary (see Fig. 5).
Conversely, the presence of an element of type <code>PT_GNU_STACK</code> in the program
header table with the <code>PF_X</code> flag set or the absence of an element of type
<code>PT_GNU_STACK</code> in the program header table indicates non-executable memory
regions are not enabled for a given binary.</p>
<p>3. See the Appendix section for more information on why it affects other
memory regions besides the stack. <a href="#fnref:3" class="reversefootnote"
role="doc-backlink">↩</a>
{: .fn #fn:3}</p>
<h3 id="stack-clashing-protection">Stack clashing protection</h3>
<p>Stack clashing protection protects the stack from overlapping with another
memory region—allowing arbitrary data in both to be overwritten using each
other—by reading from the stack pages as the stack grows to cause a page
fault when attempting to read from the guard page/region. This is also
referred to as “stack probes” or “stack probing”.</p>
<p>The Rust compiler supports stack clashing protection via stack probing, and
enables it by default since version 1.20.0 (2017-08-31)[26]–[29].</p>
<p><img alt="Screenshot listing cross references to __rust_probestack in hello-rust." src="/assets/2020/09/16/rust-exploit-mitigations/image1.png" title="Cross references to __rust_probestack in hello-rust." />
Fig. 6. Cross references to <code>__rust_probestack</code> in hello-rust.
{: .figure-caption}</p>
<pre><code class="language-rust">fn hello() {
    println!(&quot;Hello, world!&quot;);
}

fn main() {
    let _: [u64; 1024] = [0; 1024];
    hello();
}
</code></pre>
<p>Fig 7. Modified hello-rust.
{: .figure-caption}</p>
<p><img alt="Screenshot listing cross references to __rust_probestack in modified hello-rust." src="/assets/2020/09/16/rust-exploit-mitigations/image2.png" title="Cross references to __rust_probestack in modified hello-rust." />
Fig. 8. Cross references to <code>__rust_probestack</code> in modified hello-rust.
{: .figure-caption}</p>
<p>To check if stack clashing protection is enabled for a given binary, search
for cross references to <code>__rust_probestack</code>. The <code>__rust_probestack</code> is
called in the prologue of functions whose stack size is larger than a page
size (see Fig. 6), and can be forced for illustration purposes by modifying
the hello-rust example as seen in Fig. 7 and Fig. 8.</p>
<h3 id="read-only-relocations-and-immediate-binding">Read-only relocations and immediate binding</h3>
<p><strong>Read-only relocations</strong> protect segments containing relocations and
relocation information (i.e., <code>.init_array</code>, <code>.fini_array</code>, <code>.dynamic</code>, and
<code>.got</code>) from being overwritten by marking these segments read only. This is
also referred to as “partial RELRO”.</p>
<p>The Rust compiler supports read-only relocations, and enables it by default
since version 1.21.0 (2017-10-12)[30], [31].</p>
<pre><code>$ readelf -l target/release/hello-rust | grep GNU_RELRO
  GNU_RELRO      0x000000000002ee00 0x000000000002fe00 0x000000000002fe00
</code></pre>
<p>Fig. 9. Checking if read-only relocations is enabled for a given binary.
{: .figure-caption}</p>
<p>The presence of an element of type <code>PT_GNU_RELRO</code> in the program header
table indicates read-only relocations are enabled for a given binary (see
Fig. 9). Conversely, the absence of an element of type <code>PT_GNU_RELRO</code> in the
program header table indicates read-only relocations are not enabled for a
given binary.</p>
<p><strong>Immediate binding</strong> protects additional segments containing relocations
(i.e., <code>.got.plt</code>) from being overwritten by instructing the dynamic linker
to perform all relocations before transferring control to the program during
startup, so all segments containing relocations can be marked read only
(when combined with read-only relocations). This is also referred to as
“full RELRO”.</p>
<p>The Rust compiler supports immediate binding, and enables it by default
since version 1.21.0 (2017-10-12)[30], [31].</p>
<pre><code>$ readelf -d target/release/hello-rust | grep BIND_NOW
 0x000000000000001e (FLAGS)              BIND_NOW
</code></pre>
<p>Fig. 10. Checking if immediate binding is enabled for a given binary.
{: .figure-caption}</p>
<p>The presence of an element with the <code>DT_BIND_NOW</code> tag and the <code>DF_BIND_NOW</code>
flag<sup id="fnref:4" role="doc-noteref"><a href="#fn:4"
class="footnote">4</a></sup> in the dynamic section indicates immediate
binding is enabled for a given binary (see Fig. 10). Conversely, the absence
of an element with the <code>DT_BIND_NOW</code> tag and the <code>DF_BIND_NOW</code> flag in the
dynamic section indicates immediate binding is not enabled for a given
binary.</p>
<p>The presence of both an element of type <code>PT_GNU_RELRO</code> in the program header
table and of an element with the <code>DT_BIND_NOW</code> tag and the <code>DF_BIND_NOW</code>
flag in the dynamic section indicates full RELRO is enabled for a given
binary (see Fig. 9 and Fig. 10).</p>
<p>4. And the <code>DF_1_NOW</code> flag for some link editors. <a href="#fnref:4"
class="reversefootnote" role="doc-backlink">↩</a>
{: .fn #fn:4}</p>
<h3 id="heap-corruption-protection">Heap corruption protection</h3>
<p>Heap corruption protection protects memory allocated dynamically by
performing several checks, such as checks for corrupted links between list
elements, invalid pointers, invalid sizes, double/multiple “frees” of the
same memory allocated, and many corner cases of these. These checks are
implementation specific, and vary per allocator.</p>
<p><a href="https://community.arm.com/developer/ip-products/processors/b/processors-ip-blog/posts/enhancing-memory-safety">ARM Memory Tagging Extension
(MTE)</a>,
when available, will provide hardware assistance for a probabilistic
mitigation to detect memory safety violations by tagging memory allocations,
and automatically checking that the correct tag is used on every memory
access.</p>
<p>Rust’s default allocator has historically been
<a href="http://jemalloc.net/">jemalloc</a>, and it has long been the cause of issues
and the subject of much discussion[32]–[38]. Consequently, it has been
removed as the default allocator in favor of the operating system’s standard
C library default allocator<sup id="fnref:5" role="doc-noteref"><a
href="#fn:5" class="footnote">5</a></sup> since version 1.32.0
(2019-01-17)[39].</p>
<pre><code class="language-rust">fn main() {
    let mut x = Box::new([0; 1024]);

    for i in 0..1026 {
        unsafe {
            let elem = x.get_unchecked_mut(i);
            *elem = 0x4141414141414141u64;
        }
    }
}
</code></pre>
<p>Fig. 11. hello-rust-heap program.
{: .figure-caption}</p>
<pre><code>$ cargo run
   Compiling hello-rust-heap v0.1.0 (/home/rcvalle/hello-rust-heap)
    Finished dev [unoptimized + debuginfo] target(s) in 0.25s
     Running `target/debug/hello-rust-heap`
free(): invalid next size (normal)
Aborted
</code></pre>
<p>Fig. 12. Build and execution of hello-rust-heap with debug assertions
enabled.
{: .figure-caption}</p>
<pre><code>$ cargo run --release
   Compiling hello-rust-heap v0.1.0 (/home/rcvalle/hello-rust-heap)
    Finished release [optimized] target(s) in 0.25s
     Running `target/release/hello-rust-heap`
free(): invalid next size (normal)
Aborted
</code></pre>
<p>Fig. 13. Build and execution of hello-rust-heap with debug assertions
disabled.
{: .figure-caption}</p>
<p>Heap corruption checks are being performed when using the default allocator
(i.e., the GNU Allocator) as seen in Fig. 12 and Fig. 13.</p>
<p>5. Linux's standard C library default allocator is the GNU Allocator, which
is derived from ptmalloc (pthreads malloc) by Wolfram Gloger, which in turn
is derived from dlmalloc (Doug Lea malloc) by Doug Lea. <a href="#fnref:5"
class="reversefootnote" role="doc-backlink">↩</a>
{: .fn #fn:5}</p>
<h3 id="stack-smashing-protection">Stack smashing protection</h3>
<p>Stack smashing protection protects programs from stack-based buffer
overflows by inserting a random guard value between local variables and the
saved return instruction pointer, and checking if this value has changed
when returning from a function. This is also known as “Stack Protector” or
“Stack Smashing Protector (SSP)”.</p>
<p>The Rust compiler does not support stack smashing protection. However, more
comprehensive alternatives to stack smashing protection exist, such as
shadow and safe stack (see backward-edge control flow protection).</p>
<p><img alt="Screenshot listing cross references to __stack_chk_fail in hello-rust." src="/assets/2020/09/16/rust-exploit-mitigations/image3.png" title="Cross references to __stack_chk_fail in hello-rust." />
Fig. 14. Cross references to <code>__stack_chk_fail</code> in hello-rust.
{: .figure-caption}</p>
<p>To check if stack smashing protection is enabled for a given binary, search
for cross references to <code>__stack_chk_fail</code>. The only cross references to
<code>__stack_chk_fail</code> in hello-rust are from the statically-linked libbacktrace
library (see Fig. 14).</p>
<h3 id="forward-edge-control-flow-protection">Forward-edge control flow protection</h3>
<p>Forward-edge control flow protection protects programs from having its
control flow changed/hijacked by performing checks to ensure that
destinations of indirect branches are one of their valid destinations in the
control flow graph. The comprehensiveness of these checks vary per
implementation. This is also known as “forward-edge control flow integrity
(CFI)”.</p>
<p>Newer processors provide hardware assistance for forward-edge control flow
protection, such as ARM Branch Target Identification (BTI), ARM Pointer
Authentication, and Intel Indirect Branch Tracking (IBT) as part of Intel
Control-flow Enforcement Technology (CET). However, ARM BTI and Intel IBT
-based implementations are less comprehensive than software-based
implementations such as <a href="https://clang.llvm.org/docs/ControlFlowIntegrity.html">LLVM ControlFlowIntegrity
(CFI)</a>, and the
commercially available <a href="https://grsecurity.net/rap_faq">grsecurity/PaX Reuse Attack Protector
(RAP)</a>.</p>
<p>The Rust compiler supports forward-edge control flow protection on nightly
builds[40]-[41] <sup id="fnref:6" role="doc-noteref"><a href="#fn:6"
class="footnote">6</a></sup>.</p>
<pre><code class="language-text">$ readelf -s -W target/debug/rust-cfi | grep &quot;\.cfi&quot;
    12: 0000000000005170    46 FUNC    LOCAL  DEFAULT   14 _RNvCsjaOHoaNjor6_8rust_cfi7add_one.cfi
    15: 00000000000051a0    16 FUNC    LOCAL  DEFAULT   14 _RNvCsjaOHoaNjor6_8rust_cfi7add_two.cfi
    17: 0000000000005270   396 FUNC    LOCAL  DEFAULT   14 _RNvCsjaOHoaNjor6_8rust_cfi4main.cfi
...
</code></pre>
<p>Fig. 15. Checking if LLVM CFI is enabled for a given binary[41].</p>
<p>The presence of symbols suffixed with ".cfi" or the <code>__cfi_init</code> symbol (and
references to <code>__cfi_check</code>) indicates that LLVM CFI (i.e., forward-edge control
flow protection) is enabled for a given binary. Conversely, the absence of
symbols suffixed with ".cfi" or the <code>__cfi_init</code> symbol (and references to
<code>__cfi_check</code>) indicates that LLVM CFI is not enabled for a given binary (see
Fig. 15).</p>
<p><small id="fn:6">6. It also supports Control Flow Guard (CFG) on Windows (see
<a href="https://github.com/rust-lang/rust/issues/68793">https://github.com/rust-lang/rust/issues/68793</a>). <a href="#fnref:6"
class="reversefootnote" role="doc-backlink">↩</a></small></p>
<h3 id="backward-edge-control-flow-protection">Backward-edge control flow protection</h3>
<p><strong>Shadow stack</strong> protects saved return instruction pointers from being
overwritten by storing a copy of them on a separate (shadow) stack, and
using these copies as authoritative values when returning from functions.
This is also known as “ShadowCallStack” and “Return Flow Guard”, and is
considered an implementation of backward-edge control flow protection (or
“backward-edge CFI”).</p>
<p><strong>Safe stack</strong> protects not only the saved return instruction pointers, but
also register spills and some local variables from being overwritten by
storing unsafe variables, such as large arrays, on a separate (unsafe)
stack, and using these unsafe variables on the separate stack instead. This
is also known as “SafeStack”, and is also considered an implementation of
backward-edge control flow protection.</p>
<p>Both shadow and safe stack are intended to be a more comprehensive
alternatives to stack smashing protection as they protect the saved return
instruction pointers (and other data in the case of safe stack) from
arbitrary writes and non-linear out-of-bounds writes.</p>
<p>Newer processors provide hardware assistance for backward-edge control flow
protection, such as ARM Pointer Authentication, and Intel Shadow Stack as
part of Intel CET.</p>
<p>The Rust compiler does not support shadow or safe stack. There is work
currently ongoing to add support for the sanitizers[40], which may or may
not include support for safe stack<sup id="fnref:7" role="doc-noteref"><a
href="#fn:7" class="footnote">7</a></sup>.</p>
<pre><code>$ readelf -s target/release/hello-rust | grep __safestack_init
</code></pre>
<p>Fig. 16. Checking if LLVM SafeStack is enabled for a given binary.
{: .figure-caption}</p>
<p>The presence of the <code>__safestack_init</code> symbol indicates that LLVM SafeStack
is enabled for a given binary. Conversely, the absence of the
<code>__safestack_init</code> symbol indicates that LLVM SafeStack is not enabled for a
given binary (see Fig. 16).</p>
<p>7. The shadow stack implementation for the AMD64 architecture and
equivalent in LLVM was removed due to performance and security issues. <a
href="#fnref:7" class="reversefootnote" role="doc-backlink">↩</a>
{: .fn #fn:7}</p>
<h2 id="appendix">Appendix</h2>
<p>As of the latest version of the <a href="https://refspecs.linuxfoundation.org/LSB_5.0.0/LSB-Core-generic/LSB-Core-generic/progheader.html">Linux Standard Base (LSB) Core
Specification</a>,
the <code>PT_GNU_STACK</code> program header indicates whether the stack should be
executable, and the absence of this header indicates that the stack should
be executable. However, the Linux kernel currently sets the
<code>READ_IMPLIES_EXEC</code> personality upon loading any executable with the
<code>PT_GNU_STACK</code> program header and the <code>PF_X</code>flag set or with the absence of
this header, resulting in not only the stack, but also all readable virtual
memory mappings being executable.</p>
<p>An attempt to fix this <a href="https://lore.kernel.org/lkml/f298f914-2239-44e4-8aa1-a51282e7fac0@zmail15.collab.prod.int.phx2.redhat.com/">was made in
2012</a>
(by this author), and another <a href="https://lore.kernel.org/kernel-hardening/20200327064820.12602-1-keescook@chromium.org/">was made in
2020</a>.
The former never landed, and the latter partially fixed it, but introduced
other issues—the absence of the <code>PT_GNU_STACK</code> program header still causes
not only the stack, but also all readable virtual memory mappings to be
executable in some architectures, such as IA-32 and equivalent (or causes
the stack to be non-executable in some architectures, such as AMD64 and
equivalent, contradicting the LSB).</p>
<p>The <code>READ_IMPLIES_EXEC</code> personality needs to be completely separated from
the <code>PT_GNU_STACK</code> program header by having a separate option for it (or
setarch -X could just be used whenever <code>READ_IMPLIES_EXEC</code> is needed), and
the absence of the <code>PT_GNU_STACK</code> program header needs to have more secure
defaults (unrelated to <code>READ_IMPLIES_EXEC</code>).</p>
<h2 id="references">References</h2>
<ol>
<li>
<p>D. Hosfelt. “Fearless security: memory safety.” Mozilla Hacks.
   <a href="https://hacks.mozilla.org/2019/01/fearless-security-memory-safety/">https://hacks.mozilla.org/2019/01/fearless-security-memory-safety/</a>.</p>
</li>
<li>
<p>D. Hosfelt. “Fearless security: thread safety.” Mozilla Hacks.
   <a href="https://hacks.mozilla.org/2019/02/fearless-security-thread-safety/">https://hacks.mozilla.org/2019/02/fearless-security-thread-safety/</a>.</p>
</li>
<li>
<p>S. Klabnik and C. Nichols. “What Is Ownership?.” The Rust Programming
   Language. <a href="https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html">https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html</a>.</p>
</li>
<li>
<p>S. Klabnik and C. Nichols. “References and Borrowing.” The Rust
   Programming Language.
   <a href="https://doc.rust-lang.org/book/ch04-02-references-and-borrowing.html">https://doc.rust-lang.org/book/ch04-02-references-and-borrowing.html</a>.</p>
</li>
<li>
<p>S. Klabnik and C. Nichols. “The Slice Type.” The Rust Programming
   Language. <a href="https://doc.rust-lang.org/book/ch04-03-slices.html">https://doc.rust-lang.org/book/ch04-03-slices.html</a>.</p>
</li>
<li>
<p>S. Klabnik and C. Nichols. “Unsafe Rust.” The Rust Programming Language.
   <a href="https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html">https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html</a>.</p>
</li>
<li>
<p>S. Davidoff. “How Rust’s standard library was vulnerable for years and
   nobody noticed.” Medium.
   <a href="https://medium.com/@shnatsel/how-rusts-standard-library-was-vulnerable-for-years-and-nobody-noticed-aebf0503c3d6">https://medium.com/@shnatsel/how-rusts-standard-library-was-vulnerable-for-years-and-nobody-noticed-aebf0503c3d6</a>.</p>
</li>
<li>
<p>“Improper restriction of operations within the bounds of a memory buffer
   (CWE-119).” MITRE CWE List.
   <a href="https://cwe.mitre.org/data/definitions/119.html">https://cwe.mitre.org/data/definitions/119.html</a>.</p>
</li>
<li>
<p>“Concurrency issues (CWE-557).” MITRE CWE List.
   <a href="https://cwe.mitre.org/data/definitions/557.html">https://cwe.mitre.org/data/definitions/557.html</a>.</p>
</li>
<li>
<p>K. McAllister. “Memory exploit mitigations #15179.” GitHub.
    <a href="https://github.com/rust-lang/rust/issues/15179">https://github.com/rust-lang/rust/issues/15179</a>.</p>
</li>
<li>
<p>K. McAllister. “RFC: Memory exploit mitigation #145.” GitHub.
    <a href="https://github.com/rust-lang/rfcs/pull/145">https://github.com/rust-lang/rfcs/pull/145</a>.</p>
</li>
<li>
<p>K. McAllister. “RFC: Memory exploit mitigation.” GitHub.
    <a href="https://github.com/kmcallister/rfcs/blob/hardening/active/0000-memory-exploit-mitigation.md">https://github.com/kmcallister/rfcs/blob/hardening/active/0000-memory-exploit-mitigation.md</a>.</p>
</li>
<li>
<p>D. Micay. “Enable PIE by default on Linux for full ASLR #16340.” GitHub.
    <a href="https://github.com/rust-lang/rust/pull/16340">https://github.com/rust-lang/rust/pull/16340</a>.</p>
</li>
<li>
<p>N. Matsakis. “Integer overflow #560.” GitHub.
    <a href="https://github.com/rust-lang/rfcs/pull/560">https://github.com/rust-lang/rfcs/pull/560</a>.</p>
</li>
<li>
<p>G. Lehel and N. Matsakis. “Integer overflow.” GitHub.
    <a href="https://rust-lang.github.io/rfcs/0560-integer-overflow.html">https://rust-lang.github.io/rfcs/0560-integer-overflow.html</a>.</p>
</li>
<li>
<p>A. Turon. “Tracking issue for integer overflow (RFC 560) #22020.”
    GitHub. <a href="https://github.com/rust-lang/rust/issues/22020">https://github.com/rust-lang/rust/issues/22020</a>.</p>
</li>
<li>
<p>H. Wilson. “Myths and legends about integer overflow in Rust.” Huon on
    the Internet.
    <a href="http://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/">http://huonw.github.io/blog/2016/04/myths-and-legends-about-integer-overflow-in-rust/</a>.</p>
</li>
<li>
<p>B. Anderson. “Stabilize -C overflow-checks #1535.” GitHub.
    <a href="https://github.com/rust-lang/rfcs/pull/1535">https://github.com/rust-lang/rfcs/pull/1535</a>.</p>
</li>
<li>
<p>B. Anderson. “Stable overflow checks.” GitHub.
    <a href="https://github.com/brson/rfcs/blob/overflow/text/0000-stable-overflow-checks.md">https://github.com/brson/rfcs/blob/overflow/text/0000-stable-overflow-checks.md</a>.</p>
</li>
<li>
<p>N. Froyd. “Add -C overflow-checks option #40037.” GitHub.
    <a href="https://github.com/rust-lang/rust/pull/40037">https://github.com/rust-lang/rust/pull/40037</a>.</p>
</li>
<li>
<p>R. Á. de Espíndola. “rustc requires executable stack #798.” GitHub.
    <a href="https://github.com/rust-lang/rust/issues/798">https://github.com/rust-lang/rust/issues/798</a>.</p>
</li>
<li>
<p>A. Seipp. “Make sure librustrt.so is linked with a non-executable stack.
    #1066.” GitHub. <a href="https://github.com/rust-lang/rust/pull/1066">https://github.com/rust-lang/rust/pull/1066</a>.</p>
</li>
<li>
<p>D. Micay. “Rust binaries should not have an executable stack #5643.”
    GitHub. <a href="https://github.com/rust-lang/rust/issues/5643">https://github.com/rust-lang/rust/issues/5643</a>.</p>
</li>
<li>
<p>D. Micay. “Mark the assembly object stacks as non-executable #5647.”
    GitHub. <a href="https://github.com/rust-lang/rust/pull/5647">https://github.com/rust-lang/rust/pull/5647</a>.</p>
</li>
<li>
<p>A. Clark. “Explicitly disable stack execution on linux and bsd #30859.”
    GitHub. <a href="https://github.com/rust-lang/rust/pull/30859">https://github.com/rust-lang/rust/pull/30859</a>.</p>
</li>
<li>
<p>“Replace stack overflow checking with stack probes #16012.” GitHub.
    <a href="https://github.com/rust-lang/rust/issues/16012">https://github.com/rust-lang/rust/issues/16012</a>.</p>
</li>
<li>
<p>B. Striegel. “Extend stack probe support to non-tier-1 platforms, and
    clarify policy for mitigating LLVM-dependent unsafety #43241.” GitHub.
    <a href="https://github.com/rust-lang/rust/issues/43241">https://github.com/rust-lang/rust/issues/43241</a>.</p>
</li>
<li>
<p>A. Crichton. “rustc: Implement stack probes for x86 #42816.” GitHub.
    <a href="https://github.com/rust-lang/rust/pull/42816">https://github.com/rust-lang/rust/pull/42816</a>.</p>
</li>
<li>
<p>A. Crichton. “Add __rust_probestack intrinsic #175.” GitHub.
    <a href="https://github.com/rust-lang/compiler-builtins/pull/175">https://github.com/rust-lang/compiler-builtins/pull/175</a>.</p>
</li>
<li>
<p>B. Anderson. “Consider applying -Wl,-z,relro or -Wl,-z,relro,-z,now by
    default #29877.” GitHub. <a href="https://github.com/rust-lang/rust/issues/29877">https://github.com/rust-lang/rust/issues/29877</a>.</p>
</li>
<li>
<p>J. Löthberg. “Add support for full RELRO #43170.” GitHub.
    <a href="https://github.com/rust-lang/rust/pull/43170">https://github.com/rust-lang/rust/pull/43170</a>.</p>
</li>
<li>
<p>N. Matsakis. “Allocators in Rust.” Baby Steps.
    <a href="http://smallcultfollowing.com/babysteps/blog/2014/11/14/allocators-in-rust/">http://smallcultfollowing.com/babysteps/blog/2014/11/14/allocators-in-rust/</a>.</p>
</li>
<li>
<p>A. Crichton. “RFC: Allow changing the default allocator #1183.” GitHub.
    <a href="https://github.com/rust-lang/rfcs/pull/1183">https://github.com/rust-lang/rfcs/pull/1183</a>.</p>
</li>
<li>
<p>A. Crichton. “RFC: Swap out jemalloc.” GitHub.
    <a href="https://rust-lang.github.io/rfcs/1183-swap-out-jemalloc.html">https://rust-lang.github.io/rfcs/1183-swap-out-jemalloc.html</a>.</p>
</li>
<li>
<p>A. Crichton. “Tracking issue for changing the global, default allocator
    (RFC 1974) #27389.” GitHub.
    <a href="https://github.com/rust-lang/rust/issues/27389">https://github.com/rust-lang/rust/issues/27389</a>.</p>
</li>
<li>
<p>S. Fackler. “Prepare global allocators for stabilization #1974.” GitHub.
    <a href="https://github.com/rust-lang/rfcs/pull/1974">https://github.com/rust-lang/rfcs/pull/1974</a>.</p>
</li>
<li>
<p>A. Crichton. “RFC: Global allocators.” GitHub.
    <a href="https://rust-lang.github.io/rfcs/1974-global-allocators.html">https://rust-lang.github.io/rfcs/1974-global-allocators.html</a>.</p>
</li>
<li>
<p>B. Anderson. “Switch the default global allocator to System, remove
    alloc_jemalloc, use jemallocator in rustc #36963.” GitHub.
    <a href="https://github.com/rust-lang/rust/issues/36963">https://github.com/rust-lang/rust/issues/36963</a>.</p>
</li>
<li>
<p>A. Crichton. “Remove the alloc_jemalloc crate #55238.” GitHub.
    <a href="https://github.com/rust-lang/rust/pull/55238">https://github.com/rust-lang/rust/pull/55238</a>.</p>
</li>
<li>
<p>R. de C Valle. “Tracking Issue for LLVM Control Flow Integrity (CFI) Support
    for Rust #89653.” GitHub. <a href="https://github.com/rust-lang/rust/issues/89653">https://github.com/rust-lang/rust/issues/89653</a>.</p>
</li>
<li>
<p>“ControlFlowIntegrity.” The Rust Unstable Book.
    <a href="https://doc.rust-lang.org/beta/unstable-book/compiler-flags/sanitizer.html#controlflowintegrity">https://doc.rust-lang.org/beta/unstable-book/compiler-flags/sanitizer.html#controlflowintegrity</a>.
{: .references}</p>
</li>
</ol>

              

  <!-- Giscus -->
  <h2 id="__comments">Comments</h2>
  <script src="https://giscus.app/client.js"
          data-repo="rcvalle/giscus-site-rcvalle"
          data-repo-id="R_kgDOHjAgrg"
          data-category="Announcements"
          data-category-id="DIC_kwDOHjAgrs4CP1Ec"
          data-mapping="pathname"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="light"
          data-lang="en"
          crossorigin="anonymous"
          async>
  </script>

  <!-- Reload on palette change -->
  <script>
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object")
      if (palette.color.scheme === "slate") {
        var giscus = document.querySelector("script[src*=giscus]")
        giscus.setAttribute("data-theme", "dark")
      }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../vulnerabilities/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Vulnerabilities" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Vulnerabilities
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright 2022 Ramon de C Valle
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/rcvalle" target="_blank" rel="noopener" title="rcvalle on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    <a href="https://linkedin.com/in/rcvalle" target="_blank" rel="noopener" title="rcvalle on LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    <a href="https://twitter.com/rcvalle" target="_blank" rel="noopener" title="rcvalle on Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.0238f547.min.js"></script>
      
    
  </body>
</html>